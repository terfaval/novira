# AGENTS.md — Development Operating Protocol

Purpose:
Define strict operating rules for the Development Agent (Codex) to prevent scope drift, undocumented behavior, architectural inconsistencies, and documentation-code divergence.

This repository follows a spec-first, documentation-locked workflow.

---

## 1. Prime Directive

Do not implement features while documentation is inconsistent.

If documentation conflicts exist:
- Stop implementation.
- Create or follow a documentation alignment ticket.
- Resolve the conflict before writing code.

Documentation gaps are not blockers.
If something is missing but not contradictory, proceed and update documentation after implementation.

---

## 2. Source of Truth (Read Order)

1. SPEC.md
2. TICKETS.md
3. DECISIONS.md
4. SECURITY.md
5. docs/ and strategy/ (cannot override higher-priority docs)

If a lower-priority document conflicts with a higher-priority document:
- The higher-priority document wins.
- The conflict must be resolved via documentation update.

EXPORTS/ folders are immutable and must not be modified.

---

## 3. Scope Control

- Work strictly within the active ticket.
- No refactors outside ticket scope.
- No “nice-to-have” changes unless explicitly ticketed.
- Do not introduce new architectural decisions.
- Do not modify legal/* unless explicitly instructed.
- Do not modify unrelated files for cleanup.

If architectural change seems necessary:
- Stop.
- Document rationale in DECISIONS.md.
- Await explicit ticket.

---

## 4. Ticket Handling

If a task references a ticket ID that does not exist in TICKETS.md:

- Do not block execution.
- Treat the provided task description as a temporary ticket definition.
- Proceed strictly within the described scope.
- After completion, append an entry to TICKETS.md under:

  "Implemented (Ad-hoc)"

Include:
- Ticket name / ID used in prompt
- One-line goal
- Files modified
- Commit hash

---

## 5. Documentation Responsibility

Code and documentation must remain synchronized.

If implemented behavior is not reflected in:
- SPEC.md
- TICKETS.md
- DECISIONS.md
- SECURITY.md

Then:
- After implementation, update the appropriate document.
- Keep updates minimal and factual.
- Do not retroactively invent intent — document actual behavior.

Documentation gaps are signals to update documentation, not to halt progress.

---

## 6. New File Creation Authority

New files may be created only if:
- The ticket explicitly requires it, AND
- The full file content or structural intent is defined.

Do not invent file structures.
Planning-level architectural files are generated by the Planning Assistant.

---

## 7. Security Baseline

- Never embed secrets in client-side code.
- Environment variables must not be committed.
- If user-specific data exists:
  - Respect authentication boundaries.
  - Respect RLS policies (if applicable).
- Validate all external inputs.
- Do not expose internal APIs unintentionally.

If security implications are unclear:
- Document concern in SECURITY.md.

---

## 8. Webapp & UI/UX Standards

This repository builds deployable web applications (localhost + Vercel).

Minimum expectations:
- Loading states
- Empty states
- Error states with recovery guidance
- Responsive layout (mobile + desktop)

---

## 9. Commit Discipline

- Keep docs-only commits separate from feature commits.
- Do not use `git add .` during scoped tickets.
- Prefer explicit staging.

---

## 10. Definition of Done (Agent-Level)

A ticket is complete when:
- Acceptance criteria satisfied
- Lint passes
- Build passes
- Documentation updated (if needed)
- Scope respected

Operating Principle:
Predictability over cleverness.
Traceability over speed.
Stability over refactor impulse.
